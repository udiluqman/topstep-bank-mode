<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Topstep Bank Mode</title>
  <link rel="apple-touch-icon" href="./icon-192.png">
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#F7FAFC" />
  <style>
    :root{
      --bg:#F7FAFC; --card:#FFFFFF; --text:#102A43; --muted:#627D98; --border:#E6EAF0;
      --good:#2F855A; --danger:#B83232; --shadow:0 10px 26px rgba(16,42,67,.08);
      --accent:#2F6F6A;
    }
    html,body{height:100%}
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
      margin:14px; line-height:1.45; background:var(--bg); color:var(--text);
    }
    h1{font-size:28px;letter-spacing:-.02em;margin:0 0 8px}
    h2{font-size:18px;letter-spacing:-.01em;margin:0 0 10px}
    h3{font-size:15px;margin:0 0 10px}
    .muted{color:var(--muted)}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      padding:16px; margin-bottom:12px; box-shadow: var(--shadow2);
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .btn{
      display:inline-block; padding:12px 14px; border-radius:14px; border:1px solid var(--border);
      background:#fff; color:var(--text); text-decoration:none; font-weight:800;
      box-shadow: var(--shadow2); user-select:none;
    }
    .btn:active{transform:translateY(1px)}
    .btn-good{border-color:rgba(95,141,78,.35);background:rgba(95,141,78,.10);color:var(--good)}
    .btn-danger{border-color:rgba(180,83,83,.35);background:rgba(180,83,83,.10);color:var(--danger)}
    .btn-accent{border-color:rgba(76,127,122,.35);background:rgba(76,127,122,.10);color:var(--accent)}
    input,select,textarea{
      width:100%; padding:12px; border-radius:14px; border:1px solid var(--border);
      background:#fff; color:var(--text); margin-top:6px; box-sizing:border-box; outline:none;
    }
    input:focus,select:focus,textarea:focus{
      border-color:rgba(76,127,122,.55); box-shadow: var(--shadow2);
    }
    label{font-weight:800}
    hr{border:none;border-top:1px solid var(--border);margin:12px 0}
    ul{margin:8px 0 0 18px}
    .pill{
      display:inline-block; padding:8px 12px; border-radius:999px; border:1px solid var(--border);
      background:#fff; margin-right:8px; margin-bottom:8px;
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:.95em;color:var(--muted)}
    /* Celebration */
    #celebrate{
      position:fixed; inset:0; pointer-events:none; display:none;
    }
    #toast{
      position:fixed; left:50%; top:16px; transform:translateX(-50%);
      background:#fff; border:1px solid var(--border); border-radius:var(--radius);
      padding:10px 12px; box-shadow: var(--shadow2); display:none; z-index:50;
      font-weight:900;
    }
  
.heatgrid{ display:grid; grid-template-columns: repeat(6, 1fr); gap:8px; margin-top:10px; }
.heat{ font: 600 12px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial; padding:10px 8px; border-radius:14px; border:1px solid rgba(255,255,255,.12); color:rgba(255,255,255,.88); background:rgba(255,255,255,.06); }
.heat:active{ transform: scale(.98); }
@media (min-width:520px){ .heatgrid{ grid-template-columns: repeat(10, 1fr);} }


.inp{ padding:12px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); color:rgba(255,255,255,.9); outline:none; }
.inp::placeholder{ color:rgba(255,255,255,.45); }



    /* --- Behavior heat grid (light calm) --- */
    .heatgrid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin-top:10px;}
    @media (min-width:520px){.heatgrid{grid-template-columns:repeat(14,1fr);}}
    .cell{
      font:800 12px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      height:42px; display:flex; align-items:center; justify-content:center;
      border-radius:14px; border:1px solid var(--border);
      background:#FFFFFF; color:var(--muted);
      box-shadow: var(--shadow2);
      user-select:none;
    }
    .cell:active{transform:scale(.98)}
    .cell.g{background:rgba(47,133,90,.12); border-color:rgba(47,133,90,.25); color:var(--good);}
    .cell.r{background:rgba(184,50,50,.10); border-color:rgba(184,50,50,.22); color:var(--danger);}
    .cell.e{background:#FFFFFF;}

    /* Inputs (light calm) */
    .inp{
      padding:12px 12px; border-radius:14px; border:1px solid var(--border);
      background:#FFFFFF; color:var(--text); outline:none;
      box-shadow: var(--shadow2);
    }
    .inp::placeholder{color:rgba(98,125,152,.65)}

    /* --- Bank-grade minimal UI additions --- */
    .page{padding:16px 16px 86px;}
    .topbar{display:flex;align-items:flex-end;justify-content:space-between;margin:6px 0 14px;}
    .title{font-size:22px;font-weight:800;letter-spacing:-.02em;}
    .subtitle{color:var(--muted);font-size:12px;margin-top:4px;}
    .grid{display:grid;gap:12px;}
    .card.big{padding:18px;}
    .kicker{font-size:11px;letter-spacing:.12em;color:var(--muted);font-weight:800;}
    .bigNum{font-size:26px;font-weight:900;}
    .small{font-size:12px;}
    .row.between{justify-content:space-between;}
    .token{margin-top:10px;font-size:22px;font-weight:900;padding:10px 12px;border-radius:14px;display:inline-block;}
    .token.good{background:rgba(95,141,78,.12);color:var(--good);border:1px solid rgba(95,141,78,.25);}
    .token.warn{background:rgba(99,102,241,.10);color:#1D4ED8;border:1px solid rgba(29,78,216,.22);}
    .token.bad{background:rgba(180,83,83,.10);color:var(--danger);border:1px solid rgba(180,83,83,.22);}
    .bar{height:10px;background:#EEF0EA;border-radius:999px;overflow:hidden;margin-top:10px;}
    .barFill{height:100%;background:var(--good);width:0%;}
    .ruleline{margin-top:6px;color:var(--text);font-size:14px;}
    .mutepill{background:#F0F2ED;color:var(--muted);border:1px solid var(--border);}
    .goodpill{background:rgba(95,141,78,.12);color:var(--good);border:1px solid rgba(95,141,78,.25);}
    .btn.primary{background:var(--text);color:white;border-color:transparent;}
    .bottomnav{
      position:fixed;left:0;right:0;bottom:0;
      background:rgba(247,250,252,.92);
      backdrop-filter:saturate(160%) blur(10px);
      border-top:1px solid var(--border);
      display:grid;grid-template-columns:repeat(4,1fr);
      padding:10px 10px 12px;
      z-index:50;
    }
    .navbtn{display:flex;flex-direction:column;align-items:center;gap:4px;text-decoration:none;color:var(--muted);padding:6px 6px;border-radius:14px;}
    .navbtn.active{color:var(--text);background:#FFFFFF;border:1px solid var(--border);box-shadow: var(--shadow2);}
    .navicon{font-size:18px;line-height:1;}
    .navlbl{font-size:11px;font-weight:700;letter-spacing:.02em;}

  
/* --- Micro interactions (premium) --- */
.btn, .navbtn, .card { transition: transform .12s ease, box-shadow .18s ease, background-color .18s ease, border-color .18s ease; }
.btn:active, .navbtn:active { transform: scale(.98); }
.card:hover { box-shadow: var(--shadow); }

@keyframes softPulse { 0%,100%{ transform: translateY(0);} 50%{ transform: translateY(-1px);} }
.pulse { animation: softPulse 1.6s ease-in-out infinite; }

@keyframes ring { 0%{ transform: scale(.96); opacity:.35;} 50%{ transform: scale(1); opacity:.55;} 100%{ transform: scale(1.04); opacity:.25;} }
.ritualWrap{
  display:flex; align-items:center; justify-content:center; gap:18px; flex-direction:column;
}
.ritualRing{
  width:120px; height:120px; border-radius:999px;
  border:1px solid rgba(13,148,136,.25);
  background: radial-gradient(circle at 30% 30%, rgba(13,148,136,.12), rgba(13,148,136,0) 55%);
  position:relative;
}
.ritualRing::before{
  content:""; position:absolute; inset:-10px; border-radius:999px;
  border:1px solid rgba(13,148,136,.20);
  animation:ring 1.4s ease-in-out infinite;
}
.ritualRing::after{
  content:""; position:absolute; inset:18px; border-radius:999px;
  border:1px solid rgba(13,148,136,.18);
  animation:ring 1.4s ease-in-out infinite; animation-delay:.2s;
}
.ritualNum{ font-size:34px; font-weight:800; letter-spacing:-.02em; color:var(--ink); }
.ritualSub{ font-size:13px; color:var(--muted); }
.modal{
  position:fixed; inset:0; background:rgba(2,6,23,.35);
  display:flex; align-items:center; justify-content:center; padding:18px; z-index:9999;
}
.modalCard{
  width:min(420px, 100%); background:var(--card); border:1px solid var(--line);
  border-radius:var(--radius); box-shadow: var(--shadow);
  padding:16px;
}
.modalTop{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.xbtn{ width:38px; height:38px; border-radius:12px; border:1px solid var(--line); background:var(--card); display:flex; align-items:center; justify-content:center; }


/* Ritual progress ring */
.ritualProg{
  width:140px; height:140px; border-radius:999px;
  background: conic-gradient(rgba(13,148,136,.55) calc(var(--p,0)*1%), rgba(13,148,136,.10) 0);
  display:flex; align-items:center; justify-content:center;
}
.ritualInner{
  width:112px; height:112px; border-radius:999px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.98), rgba(255,255,255,.92));
  border:1px solid rgba(13,148,136,.18);
  display:flex; align-items:center; justify-content:center; flex-direction:column; gap:6px;
}
.phaseWord{ font-size:12px; letter-spacing:.18em; font-weight:800; color:rgba(15,23,42,.75); }
@keyframes microPop { 0%{transform:scale(.98);} 60%{transform:scale(1.02);} 100%{transform:scale(1);} }
.pop { animation: microPop .18s ease-out; }

</style>
</head>
<body>
  <canvas id="celebrate"></canvas>
  <div id="toast"></div>
  <div id="app"></div>

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(()=>{});
      });
    }
  </script>
  <script src="./app.js"></script>
</body>
</html>
